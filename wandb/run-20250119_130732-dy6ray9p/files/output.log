/home/archer/.local/lib/python3.10/site-packages/gym/envs/registration.py:555: UserWarning: [33mWARN: The environment SuperMarioBros-1-1-v0 is out of date. You should consider upgrading to version `v3`.[0m
  logger.warn(
No model found at mario_dqn.pth; starting from scratch.
Training:   0%|                                                                                | 0/5000 [00:00<?, ?it/s]/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:195: UserWarning: [33mWARN: The result returned by `env.reset()` was not a tuple of the form `(obs, info)`, where `obs` is a observation and `info` is a dictionary containing additional information. Actual type: `<class 'numpy.ndarray'>`[0m
  logger.warn(
/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:272: UserWarning: [33mWARN: No render modes was declared in the environment (env.metadata['render_modes'] is None or not defined), you may have trouble when calling `.render()`.[0m
  logger.warn(
/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:219: DeprecationWarning: [33mWARN: Core environment is written in old step API which returns one bool instead of two. It is recommended to rewrite the environment with new step API. [0m
  logger.deprecation(
Episode 1 | Reward: 58.81 | Eps: 0.995
Training:   1%|â–Ž                                                                   | 26/5000 [23:01<73:23:17, 53.12s/it]
Episode 2 | Reward: 235.46 | Eps: 0.990
Episode 3 | Reward: 58.81 | Eps: 0.985
Episode 4 | Reward: 248.68 | Eps: 0.980
Episode 5 | Reward: 58.81 | Eps: 0.975
Episode 6 | Reward: 58.81 | Eps: 0.970
Episode 7 | Reward: 186.81 | Eps: 0.966
Episode 8 | Reward: 58.81 | Eps: 0.961
Episode 9 | Reward: 247.76 | Eps: 0.956
[Episode 10] Model saved to mario_dqn.pth
Episode 10 | Reward: 58.81 | Eps: 0.951
Episode 11 | Reward: 58.81 | Eps: 0.946
Episode 12 | Reward: 186.81 | Eps: 0.942
Episode 13 | Reward: 58.81 | Eps: 0.937
Episode 14 | Reward: 186.81 | Eps: 0.932
Episode 15 | Reward: 58.81 | Eps: 0.928
Episode 16 | Reward: 58.81 | Eps: 0.923
Episode 17 | Reward: 246.68 | Eps: 0.918
Episode 18 | Reward: 58.81 | Eps: 0.914
Episode 19 | Reward: 241.66 | Eps: 0.909
[Episode 20] Model saved to mario_dqn.pth
Episode 20 | Reward: 58.81 | Eps: 0.905
Episode 21 | Reward: 58.81 | Eps: 0.900
Episode 22 | Reward: 245.58 | Eps: 0.896
Episode 23 | Reward: 186.81 | Eps: 0.891
Episode 24 | Reward: 58.81 | Eps: 0.887
Episode 25 | Reward: 58.81 | Eps: 0.882
Episode 26 | Reward: 58.81 | Eps: 0.878
Traceback (most recent call last):
  File "/home/archer/code/super_mario_learning/train.py", line 358, in <module>
    wandb.finish()
  File "/home/archer/code/super_mario_learning/train.py", line 314, in run_training
    if current_x_pos == prev_x_pos:
  File "/home/archer/code/super_mario_learning/train.py", line 240, in experience_replay
    self.optimizer.zero_grad()
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/optim/optimizer.py", line 947, in zero_grad
    with torch.autograd.profiler.record_function(self._zero_grad_profile_name):
  File "/home/archer/.local/lib/python3.10/site-packages/torch/autograd/profiler.py", line 750, in __exit__
    torch.ops.profiler._record_function_exit._RecordFunction(record)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_ops.py", line 940, in __call__
    if _must_dispatch_in_python(args, kwargs):
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_ops.py", line 994, in _must_dispatch_in_python
    return pytree.tree_any(
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 1203, in tree_any
    return any(map(pred, flat_args))
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 904, in tree_iter
    yield from tree_iter(child, is_leaf=is_leaf)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 904, in tree_iter
    yield from tree_iter(child, is_leaf=is_leaf)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 895, in tree_iter
    if _is_leaf(tree, is_leaf=is_leaf):
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/archer/code/super_mario_learning/train.py", line 358, in <module>
    wandb.finish()
  File "/home/archer/code/super_mario_learning/train.py", line 314, in run_training
    if current_x_pos == prev_x_pos:
  File "/home/archer/code/super_mario_learning/train.py", line 240, in experience_replay
    self.optimizer.zero_grad()
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/optim/optimizer.py", line 947, in zero_grad
    with torch.autograd.profiler.record_function(self._zero_grad_profile_name):
  File "/home/archer/.local/lib/python3.10/site-packages/torch/autograd/profiler.py", line 750, in __exit__
    torch.ops.profiler._record_function_exit._RecordFunction(record)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_ops.py", line 940, in __call__
    if _must_dispatch_in_python(args, kwargs):
  File "/home/archer/.local/lib/python3.10/site-packages/torch/_ops.py", line 994, in _must_dispatch_in_python
    return pytree.tree_any(
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 1203, in tree_any
    return any(map(pred, flat_args))
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 904, in tree_iter
    yield from tree_iter(child, is_leaf=is_leaf)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 904, in tree_iter
    yield from tree_iter(child, is_leaf=is_leaf)
  File "/home/archer/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 895, in tree_iter
    if _is_leaf(tree, is_leaf=is_leaf):
KeyboardInterrupt
