/home/archer/.local/lib/python3.10/site-packages/gym/envs/registration.py:555: UserWarning: [33mWARN: The environment SuperMarioBros-1-1-v0 is out of date. You should consider upgrading to version `v3`.[0m
  logger.warn(
Loading model from mario_dqn.pth ...
/home/archer/code/super_mario_learning/train.py:279: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  agent.local_net.load_state_dict(torch.load(load_model, map_location=device))
Model loaded successfully. Training will resume from this checkpoint.
Training:   0%|                                                                               | 0/50000 [00:00<?, ?it/s]/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:195: UserWarning: [33mWARN: The result returned by `env.reset()` was not a tuple of the form `(obs, info)`, where `obs` is a observation and `info` is a dictionary containing additional information. Actual type: `<class 'numpy.ndarray'>`[0m
  logger.warn(
/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:272: UserWarning: [33mWARN: No render modes was declared in the environment (env.metadata['render_modes'] is None or not defined), you may have trouble when calling `.render()`.[0m
  logger.warn(
/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:219: DeprecationWarning: [33mWARN: Core environment is written in old step API which returns one bool instead of two. It is recommended to rewrite the environment with new step API. [0m
  logger.deprecation(
Episode 1 | Reward: 139.00 | Eps: 0.900
Training:   0%|                                                                  | 32/50000 [25:32<689:11:13, 49.65s/it]
Episode 2 | Reward: 267.00 | Eps: 0.900
Episode 3 | Reward: 139.00 | Eps: 0.900
Episode 4 | Reward: 139.00 | Eps: 0.900
Episode 5 | Reward: 139.00 | Eps: 0.900
Episode 6 | Reward: 139.00 | Eps: 0.900
Episode 7 | Reward: 267.00 | Eps: 0.900
Episode 8 | Reward: 139.00 | Eps: 0.900
Episode 9 | Reward: 139.00 | Eps: 0.900
Episode 10 | Reward: 637.00 | Eps: 0.900
Episode 11 | Reward: 239.00 | Eps: 0.900
Episode 12 | Reward: 246.00 | Eps: 0.900
Episode 13 | Reward: 267.00 | Eps: 0.900
Episode 14 | Reward: 420.00 | Eps: 0.900
Episode 15 | Reward: 139.00 | Eps: 0.900
Episode 16 | Reward: 139.00 | Eps: 0.900
Episode 17 | Reward: 139.00 | Eps: 0.900
Episode 18 | Reward: 250.00 | Eps: 0.900
Episode 19 | Reward: 267.00 | Eps: 0.900
Episode 20 | Reward: 267.00 | Eps: 0.900
Episode 21 | Reward: 382.00 | Eps: 0.900
Episode 22 | Reward: 267.00 | Eps: 0.900
Episode 23 | Reward: 237.00 | Eps: 0.900
Episode 24 | Reward: 139.00 | Eps: 0.900
Episode 25 | Reward: 267.00 | Eps: 0.900
Episode 26 | Reward: 139.00 | Eps: 0.900
Episode 27 | Reward: 251.00 | Eps: 0.900
Episode 28 | Reward: 267.00 | Eps: 0.900
Episode 29 | Reward: 267.00 | Eps: 0.900
Episode 30 | Reward: 245.00 | Eps: 0.900
Episode 31 | Reward: 139.00 | Eps: 0.900
Episode 32 | Reward: 267.00 | Eps: 0.900
Episode 33 | Reward: 233.00 | Eps: 0.900
Episode 34 | Reward: 139.00 | Eps: 0.900
Episode 35 | Reward: 238.00 | Eps: 0.900
Episode 36 | Reward: 139.00 | Eps: 0.900
Episode 37 | Reward: 242.00 | Eps: 0.900
Episode 38 | Reward: 240.00 | Eps: 0.900
Episode 39 | Reward: 139.00 | Eps: 0.900
Episode 40 | Reward: 139.00 | Eps: 0.900
Episode 41 | Reward: 239.00 | Eps: 0.900
Episode 42 | Reward: 139.00 | Eps: 0.900
Episode 43 | Reward: 139.00 | Eps: 0.900
Episode 44 | Reward: 139.00 | Eps: 0.900
Episode 45 | Reward: 139.00 | Eps: 0.900
Episode 46 | Reward: 139.00 | Eps: 0.900
Episode 47 | Reward: 139.00 | Eps: 0.900
Episode 48 | Reward: 245.00 | Eps: 0.900
Episode 49 | Reward: 139.00 | Eps: 0.900
Episode 50 | Reward: 267.00 | Eps: 0.900
Episode 51 | Reward: 267.00 | Eps: 0.900
Episode 52 | Reward: 139.00 | Eps: 0.900
Episode 53 | Reward: 139.00 | Eps: 0.900
Episode 54 | Reward: 267.00 | Eps: 0.900
Episode 55 | Reward: 267.00 | Eps: 0.900
Episode 56 | Reward: 139.00 | Eps: 0.900
Episode 57 | Reward: 139.00 | Eps: 0.900
Episode 58 | Reward: 267.00 | Eps: 0.900
Episode 59 | Reward: 240.00 | Eps: 0.900
Episode 60 | Reward: 243.00 | Eps: 0.900
Episode 61 | Reward: 139.00 | Eps: 0.900
Episode 62 | Reward: 139.00 | Eps: 0.900
Episode 63 | Reward: 267.00 | Eps: 0.900
Episode 64 | Reward: 246.00 | Eps: 0.900
Episode 65 | Reward: 267.00 | Eps: 0.900
Episode 66 | Reward: 139.00 | Eps: 0.900
Episode 67 | Reward: 139.00 | Eps: 0.900
Episode 68 | Reward: 139.00 | Eps: 0.900
Episode 69 | Reward: 267.00 | Eps: 0.900
Episode 70 | Reward: 139.00 | Eps: 0.900
Episode 71 | Reward: 139.00 | Eps: 0.900
Episode 72 | Reward: 267.00 | Eps: 0.900
Episode 73 | Reward: 139.00 | Eps: 0.900
Episode 74 | Reward: 248.00 | Eps: 0.900
Episode 75 | Reward: 139.00 | Eps: 0.900
Episode 76 | Reward: 139.00 | Eps: 0.900
Episode 77 | Reward: 139.00 | Eps: 0.900
Episode 78 | Reward: 267.00 | Eps: 0.900
Episode 79 | Reward: 139.00 | Eps: 0.900
Episode 80 | Reward: 246.00 | Eps: 0.900
Episode 81 | Reward: 139.00 | Eps: 0.900
Episode 82 | Reward: 231.00 | Eps: 0.900
Episode 83 | Reward: 139.00 | Eps: 0.900
Episode 84 | Reward: 247.00 | Eps: 0.900
Episode 85 | Reward: 541.00 | Eps: 0.900
Episode 86 | Reward: 267.00 | Eps: 0.900
Episode 87 | Reward: 267.00 | Eps: 0.900
Episode 88 | Reward: 231.00 | Eps: 0.900
Episode 89 | Reward: 139.00 | Eps: 0.900
Episode 90 | Reward: 267.00 | Eps: 0.900
Episode 91 | Reward: 139.00 | Eps: 0.900
Episode 92 | Reward: 267.00 | Eps: 0.900
Episode 93 | Reward: 267.00 | Eps: 0.900
Episode 94 | Reward: 139.00 | Eps: 0.900
Episode 95 | Reward: 267.00 | Eps: 0.900
Episode 96 | Reward: 248.00 | Eps: 0.900
Episode 97 | Reward: 139.00 | Eps: 0.900
Episode 98 | Reward: 139.00 | Eps: 0.900
Episode 99 | Reward: 251.00 | Eps: 0.900
[Episode 100] Model saved to mario_dqn.pth
Episode 100 | Reward: 267.00 | Eps: 0.900
Episode 101 | Reward: 139.00 | Eps: 0.900
Episode 102 | Reward: 139.00 | Eps: 0.900
Episode 103 | Reward: 245.00 | Eps: 0.900
Episode 104 | Reward: 245.00 | Eps: 0.900
Episode 105 | Reward: 515.00 | Eps: 0.900
Episode 106 | Reward: 418.00 | Eps: 0.900
Episode 107 | Reward: 139.00 | Eps: 0.900
Episode 108 | Reward: 242.00 | Eps: 0.900
Episode 109 | Reward: 440.00 | Eps: 0.900
Episode 110 | Reward: 267.00 | Eps: 0.900
Episode 111 | Reward: 139.00 | Eps: 0.900
Episode 112 | Reward: 241.00 | Eps: 0.900
Episode 113 | Reward: 139.00 | Eps: 0.900
Episode 114 | Reward: 233.00 | Eps: 0.900
Episode 115 | Reward: 267.00 | Eps: 0.900
Episode 116 | Reward: 241.00 | Eps: 0.900
Episode 117 | Reward: 637.00 | Eps: 0.900
Episode 118 | Reward: 251.00 | Eps: 0.900
Episode 119 | Reward: 139.00 | Eps: 0.900
Episode 120 | Reward: 510.00 | Eps: 0.900
Episode 121 | Reward: 429.00 | Eps: 0.900
Episode 122 | Reward: 139.00 | Eps: 0.900
Episode 123 | Reward: 242.00 | Eps: 0.900
Episode 124 | Reward: 249.00 | Eps: 0.900
Episode 125 | Reward: 267.00 | Eps: 0.900
Episode 126 | Reward: 139.00 | Eps: 0.900
Episode 127 | Reward: 139.00 | Eps: 0.900
Episode 128 | Reward: 239.00 | Eps: 0.900
Episode 129 | Reward: 139.00 | Eps: 0.900
Episode 130 | Reward: 241.00 | Eps: 0.900
Episode 131 | Reward: 242.00 | Eps: 0.900
Episode 132 | Reward: 267.00 | Eps: 0.900
Episode 133 | Reward: 237.00 | Eps: 0.900
Episode 134 | Reward: 248.00 | Eps: 0.900
Episode 135 | Reward: 247.00 | Eps: 0.900
Episode 136 | Reward: 139.00 | Eps: 0.900
Episode 137 | Reward: 139.00 | Eps: 0.900
Episode 138 | Reward: 139.00 | Eps: 0.900
Episode 139 | Reward: 246.00 | Eps: 0.900
Episode 140 | Reward: 139.00 | Eps: 0.900
Episode 141 | Reward: 139.00 | Eps: 0.900
Episode 142 | Reward: 139.00 | Eps: 0.900
Traceback (most recent call last):
  File "/home/archer/code/super_mario_learning/train.py", line 352, in <module>
    # Save model every 10 episodes
  File "/home/archer/code/super_mario_learning/train.py", line 301, in run_training
    action = agent.act(stacked_state)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/wrappers/joypad_space.py", line 74, in step
    return self.env.step(self._action_map[action])
  File "/home/archer/code/super_mario_learning/train.py", line 40, in step
    obs, reward, done, info = self.env.step(action)  # old (obs, reward, done, info)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/order_enforcing.py", line 37, in step
    return self.env.step(action)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/env_checker.py", line 39, in step
    return self.env.step(action)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/nes_env.py", line 300, in step
    _LIB.Step(self._env)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/archer/code/super_mario_learning/train.py", line 352, in <module>
    # Save model every 10 episodes
  File "/home/archer/code/super_mario_learning/train.py", line 301, in run_training
    action = agent.act(stacked_state)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/wrappers/joypad_space.py", line 74, in step
    return self.env.step(self._action_map[action])
  File "/home/archer/code/super_mario_learning/train.py", line 40, in step
    obs, reward, done, info = self.env.step(action)  # old (obs, reward, done, info)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/order_enforcing.py", line 37, in step
    return self.env.step(action)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/env_checker.py", line 39, in step
    return self.env.step(action)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/nes_env.py", line 300, in step
    _LIB.Step(self._env)
KeyboardInterrupt
