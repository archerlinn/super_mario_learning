/home/archer/.local/lib/python3.10/site-packages/gym/envs/registration.py:555: UserWarning: [33mWARN: The environment SuperMarioBros-1-1-v0 is out of date. You should consider upgrading to version `v3`.[0m
  logger.warn(
Loading model from mario_dqn.pth ...
/home/archer/code/super_mario_learning/train.py:277: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  agent.local_net.load_state_dict(torch.load(load_model, map_location=device))
Model loaded successfully. Training will resume from this checkpoint.
Training:   0%|                                                                                              | 0/5000 [00:00<?, ?it/s]/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:195: UserWarning: [33mWARN: The result returned by `env.reset()` was not a tuple of the form `(obs, info)`, where `obs` is a observation and `info` is a dictionary containing additional information. Actual type: `<class 'numpy.ndarray'>`[0m
  logger.warn(
/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:272: UserWarning: [33mWARN: No render modes was declared in the environment (env.metadata['render_modes'] is None or not defined), you may have trouble when calling `.render()`.[0m
  logger.warn(
/home/archer/.local/lib/python3.10/site-packages/gym/utils/passive_env_checker.py:219: DeprecationWarning: [33mWARN: Core environment is written in old step API which returns one bool instead of two. It is recommended to rewrite the environment with new step API. [0m
  logger.deprecation(
Episode 1 | Reward: 652.68 | Eps: 0.200
Training:   1%|‚ñç                                                                                 | 29/5000 [04:09<15:28:21, 11.21s/it]
Episode 2 | Reward: 1088.26 | Eps: 0.200
Episode 3 | Reward: 649.14 | Eps: 0.200
Episode 4 | Reward: 783.46 | Eps: 0.200
Episode 5 | Reward: 781.54 | Eps: 0.200
Episode 6 | Reward: 1068.46 | Eps: 0.199
Episode 7 | Reward: 1334.91 | Eps: 0.199
Episode 8 | Reward: 260.10 | Eps: 0.199
Episode 9 | Reward: 995.81 | Eps: 0.199
[Episode 10] Model saved to mario_dqn.pth
Episode 10 | Reward: 679.28 | Eps: 0.199
Episode 11 | Reward: 1434.56 | Eps: 0.199
Episode 12 | Reward: 254.64 | Eps: 0.199
Episode 13 | Reward: 261.24 | Eps: 0.199
Episode 14 | Reward: 644.18 | Eps: 0.199
Episode 15 | Reward: 261.24 | Eps: 0.199
Episode 16 | Reward: 244.90 | Eps: 0.198
Episode 17 | Reward: 257.92 | Eps: 0.198
Episode 18 | Reward: 262.36 | Eps: 0.198
Episode 19 | Reward: 1048.84 | Eps: 0.198
[Episode 20] Model saved to mario_dqn.pth
Episode 20 | Reward: 257.98 | Eps: 0.198
Episode 21 | Reward: 1393.61 | Eps: 0.198
Episode 22 | Reward: 1096.99 | Eps: 0.198
Episode 23 | Reward: 1403.51 | Eps: 0.198
Episode 24 | Reward: 1991.06 | Eps: 0.198
Episode 25 | Reward: 1096.01 | Eps: 0.198
Episode 26 | Reward: 1453.04 | Eps: 0.197
Episode 27 | Reward: 2094.20 | Eps: 0.197
Episode 28 | Reward: 1441.16 | Eps: 0.197
Episode 29 | Reward: 1118.63 | Eps: 0.197
[Episode 30] Model saved to mario_dqn.pth
Episode 30 | Reward: 659.78 | Eps: 0.197
Episode 31 | Reward: 1373.61 | Eps: 0.197
Episode 32 | Reward: 258.96 | Eps: 0.197
Episode 33 | Reward: 870.56 | Eps: 0.197
Episode 34 | Reward: 261.26 | Eps: 0.197
Episode 35 | Reward: 1423.29 | Eps: 0.197
Episode 36 | Reward: 250.04 | Eps: 0.196
Episode 37 | Reward: 241.34 | Eps: 0.196
Episode 38 | Reward: 799.02 | Eps: 0.196
Episode 39 | Reward: 777.88 | Eps: 0.196
[Episode 40] Model saved to mario_dqn.pth
Episode 40 | Reward: 1404.43 | Eps: 0.196
Episode 41 | Reward: 866.78 | Eps: 0.196
Episode 42 | Reward: 683.74 | Eps: 0.196
Episode 43 | Reward: 1407.96 | Eps: 0.196
Episode 44 | Reward: 665.18 | Eps: 0.196
Episode 45 | Reward: 260.14 | Eps: 0.196
Episode 46 | Reward: 1439.07 | Eps: 0.195
Episode 47 | Reward: 1506.22 | Eps: 0.195
Episode 48 | Reward: 260.16 | Eps: 0.195
Episode 49 | Reward: 219.06 | Eps: 0.195
[Episode 50] Model saved to mario_dqn.pth
Episode 50 | Reward: 673.74 | Eps: 0.195
Episode 51 | Reward: 1417.57 | Eps: 0.195
Episode 52 | Reward: 1438.82 | Eps: 0.195
Episode 53 | Reward: 1107.36 | Eps: 0.195
Episode 54 | Reward: 804.62 | Eps: 0.195
Episode 55 | Reward: 1467.34 | Eps: 0.195
Episode 56 | Reward: 665.04 | Eps: 0.194
Episode 57 | Reward: 667.52 | Eps: 0.194
Episode 58 | Reward: 793.76 | Eps: 0.194
Episode 59 | Reward: 1139.61 | Eps: 0.194
[Episode 60] Model saved to mario_dqn.pth
Episode 60 | Reward: 821.84 | Eps: 0.194
Episode 61 | Reward: 259.10 | Eps: 0.194
Episode 62 | Reward: 1116.47 | Eps: 0.194
Episode 63 | Reward: 1021.87 | Eps: 0.194
Episode 64 | Reward: 262.28 | Eps: 0.194
Episode 65 | Reward: 243.56 | Eps: 0.194
Episode 66 | Reward: 249.12 | Eps: 0.194
Episode 67 | Reward: 663.90 | Eps: 0.193
Episode 68 | Reward: 247.88 | Eps: 0.193
Episode 69 | Reward: 1441.70 | Eps: 0.193
[Episode 70] Model saved to mario_dqn.pth
Episode 70 | Reward: 623.24 | Eps: 0.193
Episode 71 | Reward: 1069.85 | Eps: 0.193
Episode 72 | Reward: 681.28 | Eps: 0.193
Episode 73 | Reward: 682.50 | Eps: 0.193
Episode 74 | Reward: 869.12 | Eps: 0.193
Episode 75 | Reward: 854.04 | Eps: 0.193
Episode 76 | Reward: 1356.83 | Eps: 0.193
Episode 77 | Reward: 864.66 | Eps: 0.192
Episode 78 | Reward: 1497.78 | Eps: 0.192
Episode 79 | Reward: 256.88 | Eps: 0.192
[Episode 80] Model saved to mario_dqn.pth
Episode 80 | Reward: 750.08 | Eps: 0.192
Episode 81 | Reward: 1085.34 | Eps: 0.192
Episode 82 | Reward: 680.34 | Eps: 0.192
Episode 83 | Reward: 701.40 | Eps: 0.192
Episode 84 | Reward: 650.90 | Eps: 0.192
Episode 85 | Reward: 242.26 | Eps: 0.192
Episode 86 | Reward: 674.16 | Eps: 0.192
Episode 87 | Reward: 1994.26 | Eps: 0.191
Episode 88 | Reward: 667.26 | Eps: 0.191
Episode 89 | Reward: 246.78 | Eps: 0.191
[Episode 90] Model saved to mario_dqn.pth
Episode 90 | Reward: 870.08 | Eps: 0.191
Episode 91 | Reward: 237.90 | Eps: 0.191
Episode 92 | Reward: 799.68 | Eps: 0.191
Episode 93 | Reward: 647.24 | Eps: 0.191
Episode 94 | Reward: 1250.28 | Eps: 0.191
Episode 95 | Reward: 242.30 | Eps: 0.191
Episode 96 | Reward: 1427.80 | Eps: 0.191
Episode 97 | Reward: 1827.64 | Eps: 0.191
Episode 98 | Reward: 251.14 | Eps: 0.190
Episode 99 | Reward: 1092.86 | Eps: 0.190
[Episode 100] Model saved to mario_dqn.pth
Episode 100 | Reward: 875.86 | Eps: 0.190
Episode 101 | Reward: 241.12 | Eps: 0.190
Episode 102 | Reward: 256.66 | Eps: 0.190
Episode 103 | Reward: 674.76 | Eps: 0.190
Episode 104 | Reward: 253.48 | Eps: 0.190
Episode 105 | Reward: 878.22 | Eps: 0.190
Episode 106 | Reward: 656.24 | Eps: 0.190
Episode 107 | Reward: 1430.84 | Eps: 0.190
Episode 108 | Reward: 1119.76 | Eps: 0.189
Episode 109 | Reward: 1339.38 | Eps: 0.189
[Episode 110] Model saved to mario_dqn.pth
Episode 110 | Reward: 665.92 | Eps: 0.189
Episode 111 | Reward: 249.00 | Eps: 0.189
Episode 112 | Reward: 243.34 | Eps: 0.189
Episode 113 | Reward: 1340.58 | Eps: 0.189
Episode 114 | Reward: 2019.12 | Eps: 0.189
Episode 115 | Reward: 733.22 | Eps: 0.189
Episode 116 | Reward: 1454.74 | Eps: 0.189
Episode 117 | Reward: 641.34 | Eps: 0.189
Episode 118 | Reward: 669.58 | Eps: 0.189
Episode 119 | Reward: 1107.40 | Eps: 0.188
[Episode 120] Model saved to mario_dqn.pth
Episode 120 | Reward: 1647.50 | Eps: 0.188
Episode 121 | Reward: 771.52 | Eps: 0.188
Episode 122 | Reward: 1842.10 | Eps: 0.188
Episode 123 | Reward: 1115.70 | Eps: 0.188
Episode 124 | Reward: 256.86 | Eps: 0.188
Episode 125 | Reward: 1078.37 | Eps: 0.188
Episode 126 | Reward: 250.32 | Eps: 0.188
Episode 127 | Reward: 1420.51 | Eps: 0.188
Episode 128 | Reward: 262.34 | Eps: 0.188
Episode 129 | Reward: 1446.20 | Eps: 0.188
[Episode 130] Model saved to mario_dqn.pth
Episode 130 | Reward: 681.80 | Eps: 0.187
Episode 131 | Reward: 240.20 | Eps: 0.187
Episode 132 | Reward: 256.86 | Eps: 0.187
Episode 133 | Reward: 667.32 | Eps: 0.187
Episode 134 | Reward: 1225.82 | Eps: 0.187
Episode 135 | Reward: 863.38 | Eps: 0.187
Episode 136 | Reward: 242.36 | Eps: 0.187
Episode 137 | Reward: 1123.55 | Eps: 0.187
Episode 138 | Reward: 239.20 | Eps: 0.187
Episode 139 | Reward: 1545.96 | Eps: 0.187
[Episode 140] Model saved to mario_dqn.pth
Episode 140 | Reward: 1099.18 | Eps: 0.186
Episode 141 | Reward: 654.46 | Eps: 0.186
Episode 142 | Reward: 684.30 | Eps: 0.186
Episode 143 | Reward: 1127.00 | Eps: 0.186
Episode 144 | Reward: 774.44 | Eps: 0.186
Episode 145 | Reward: 1107.42 | Eps: 0.186
Episode 146 | Reward: 256.80 | Eps: 0.186
Episode 147 | Reward: 1958.90 | Eps: 0.186
Episode 148 | Reward: 260.14 | Eps: 0.186
Episode 149 | Reward: 702.60 | Eps: 0.186
[Episode 150] Model saved to mario_dqn.pth
Episode 150 | Reward: 1140.80 | Eps: 0.186
Episode 151 | Reward: 780.44 | Eps: 0.185
Episode 152 | Reward: 683.06 | Eps: 0.185
Episode 153 | Reward: 260.18 | Eps: 0.185
Episode 154 | Reward: 1403.66 | Eps: 0.185
Episode 155 | Reward: 261.26 | Eps: 0.185
Episode 156 | Reward: 2008.52 | Eps: 0.185
Episode 157 | Reward: 1330.80 | Eps: 0.185
Episode 158 | Reward: 847.66 | Eps: 0.185
Episode 159 | Reward: 260.20 | Eps: 0.185
[Episode 160] Model saved to mario_dqn.pth
Episode 160 | Reward: 774.50 | Eps: 0.185
Episode 161 | Reward: 244.72 | Eps: 0.185
Episode 162 | Reward: 1079.86 | Eps: 0.184
Episode 163 | Reward: 623.98 | Eps: 0.184
Episode 164 | Reward: 1101.97 | Eps: 0.184
Episode 165 | Reward: 259.02 | Eps: 0.184
Episode 166 | Reward: 639.70 | Eps: 0.184
Episode 167 | Reward: 1416.14 | Eps: 0.184
Episode 168 | Reward: 1368.51 | Eps: 0.184
Episode 169 | Reward: 676.50 | Eps: 0.184
[Episode 170] Model saved to mario_dqn.pth
Episode 170 | Reward: 1097.13 | Eps: 0.184
Episode 171 | Reward: 259.02 | Eps: 0.184
Episode 172 | Reward: 682.60 | Eps: 0.184
Episode 173 | Reward: 1129.09 | Eps: 0.183
Episode 174 | Reward: 259.08 | Eps: 0.183
Episode 175 | Reward: 649.98 | Eps: 0.183
Episode 176 | Reward: 1427.60 | Eps: 0.183
Episode 177 | Reward: 784.62 | Eps: 0.183
Episode 178 | Reward: 215.98 | Eps: 0.183
Episode 179 | Reward: 1108.60 | Eps: 0.183
[Episode 180] Model saved to mario_dqn.pth
Episode 180 | Reward: 254.66 | Eps: 0.183
Episode 181 | Reward: 1092.27 | Eps: 0.183
Episode 182 | Reward: 259.04 | Eps: 0.183
Episode 183 | Reward: 230.10 | Eps: 0.183
Episode 184 | Reward: 1095.74 | Eps: 0.182
Episode 185 | Reward: 867.16 | Eps: 0.182
Episode 186 | Reward: 1408.97 | Eps: 0.182
Episode 187 | Reward: 254.52 | Eps: 0.182
Episode 188 | Reward: 1101.65 | Eps: 0.182
Episode 189 | Reward: 642.80 | Eps: 0.182
[Episode 190] Model saved to mario_dqn.pth
Episode 190 | Reward: 681.76 | Eps: 0.182
Episode 191 | Reward: 1130.41 | Eps: 0.182
Episode 192 | Reward: 660.52 | Eps: 0.182
Episode 193 | Reward: 653.74 | Eps: 0.182
Episode 194 | Reward: 1421.38 | Eps: 0.182
Episode 195 | Reward: 659.20 | Eps: 0.181
Episode 196 | Reward: 1419.51 | Eps: 0.181
Episode 197 | Reward: 658.16 | Eps: 0.181
Episode 198 | Reward: 1398.06 | Eps: 0.181
Episode 199 | Reward: 255.62 | Eps: 0.181
[Episode 200] Model saved to mario_dqn.pth
Episode 200 | Reward: 670.38 | Eps: 0.181
Episode 201 | Reward: 1330.89 | Eps: 0.181
Episode 202 | Reward: 641.54 | Eps: 0.181
Episode 203 | Reward: 256.88 | Eps: 0.181
Episode 204 | Reward: 253.54 | Eps: 0.181
Episode 205 | Reward: 800.40 | Eps: 0.181
Episode 206 | Reward: 685.86 | Eps: 0.180
Episode 207 | Reward: 659.60 | Eps: 0.180
Episode 208 | Reward: 675.66 | Eps: 0.180
Episode 209 | Reward: 1099.82 | Eps: 0.180
[Episode 210] Model saved to mario_dqn.pth
Episode 210 | Reward: 641.34 | Eps: 0.180
Episode 211 | Reward: 1121.92 | Eps: 0.180
Episode 212 | Reward: 1441.99 | Eps: 0.180
Episode 213 | Reward: 1228.04 | Eps: 0.180
Episode 214 | Reward: 641.20 | Eps: 0.180
Episode 215 | Reward: 970.25 | Eps: 0.180
Episode 216 | Reward: 685.74 | Eps: 0.180
Episode 217 | Reward: 247.92 | Eps: 0.179
Episode 218 | Reward: 681.46 | Eps: 0.179
Episode 219 | Reward: 252.24 | Eps: 0.179
[Episode 220] Model saved to mario_dqn.pth
Episode 220 | Reward: 660.16 | Eps: 0.179
Episode 221 | Reward: 793.00 | Eps: 0.179
Episode 222 | Reward: 1065.59 | Eps: 0.179
Episode 223 | Reward: 1386.19 | Eps: 0.179
Episode 224 | Reward: 1431.23 | Eps: 0.179
Episode 225 | Reward: 244.56 | Eps: 0.179
Episode 226 | Reward: 226.90 | Eps: 0.179
Episode 227 | Reward: 1414.54 | Eps: 0.179
Episode 228 | Reward: 1094.61 | Eps: 0.178
Episode 229 | Reward: 746.56 | Eps: 0.178
[Episode 230] Model saved to mario_dqn.pth
Episode 230 | Reward: 1509.92 | Eps: 0.178
Episode 231 | Reward: 1957.30 | Eps: 0.178
Episode 232 | Reward: 1118.47 | Eps: 0.178
Episode 233 | Reward: 248.92 | Eps: 0.178
Episode 234 | Reward: 804.22 | Eps: 0.178
Episode 235 | Reward: 668.66 | Eps: 0.178
Episode 236 | Reward: 231.40 | Eps: 0.178
Episode 237 | Reward: 804.54 | Eps: 0.178
Episode 238 | Reward: 1149.99 | Eps: 0.178
Episode 239 | Reward: 252.26 | Eps: 0.177
[Episode 240] Model saved to mario_dqn.pth
Episode 240 | Reward: 660.80 | Eps: 0.177
Episode 241 | Reward: 797.44 | Eps: 0.177
Episode 242 | Reward: 656.60 | Eps: 0.177
Episode 243 | Reward: 656.66 | Eps: 0.177
Episode 244 | Reward: 1402.39 | Eps: 0.177
Episode 245 | Reward: 645.84 | Eps: 0.177
Episode 246 | Reward: 1431.86 | Eps: 0.177
Episode 247 | Reward: 677.12 | Eps: 0.177
Episode 248 | Reward: 699.14 | Eps: 0.177
Episode 249 | Reward: 235.96 | Eps: 0.177
[Episode 250] Model saved to mario_dqn.pth
Episode 250 | Reward: 680.70 | Eps: 0.176
Episode 251 | Reward: 1558.80 | Eps: 0.176
Episode 252 | Reward: 1125.79 | Eps: 0.176
Episode 253 | Reward: 1855.54 | Eps: 0.176
Episode 254 | Reward: 1455.23 | Eps: 0.176
Episode 255 | Reward: 654.28 | Eps: 0.176
Episode 256 | Reward: 876.32 | Eps: 0.176
Episode 257 | Reward: 684.08 | Eps: 0.176
Episode 258 | Reward: 1116.74 | Eps: 0.176
Episode 259 | Reward: 1126.16 | Eps: 0.176
[Episode 260] Model saved to mario_dqn.pth
Episode 260 | Reward: 1509.74 | Eps: 0.176
Episode 261 | Reward: 674.82 | Eps: 0.176
Episode 262 | Reward: 1080.54 | Eps: 0.175
Episode 263 | Reward: 800.02 | Eps: 0.175
Episode 264 | Reward: 659.44 | Eps: 0.175
Episode 265 | Reward: 677.10 | Eps: 0.175
Episode 266 | Reward: 759.72 | Eps: 0.175
Episode 267 | Reward: 249.16 | Eps: 0.175
Episode 268 | Reward: 1423.62 | Eps: 0.175
Episode 269 | Reward: 259.06 | Eps: 0.175
[Episode 270] Model saved to mario_dqn.pth
Episode 270 | Reward: 1509.16 | Eps: 0.175
Episode 271 | Reward: 680.48 | Eps: 0.175
Episode 272 | Reward: 673.78 | Eps: 0.175
Episode 273 | Reward: 1114.26 | Eps: 0.174
Episode 274 | Reward: 763.80 | Eps: 0.174
Episode 275 | Reward: 247.90 | Eps: 0.174
Episode 276 | Reward: 251.24 | Eps: 0.174
Episode 277 | Reward: 663.16 | Eps: 0.174
Episode 278 | Reward: 657.20 | Eps: 0.174
Episode 279 | Reward: 804.34 | Eps: 0.174
[Episode 280] Model saved to mario_dqn.pth
Episode 280 | Reward: 252.32 | Eps: 0.174
Episode 281 | Reward: 618.24 | Eps: 0.174
Episode 282 | Reward: 248.94 | Eps: 0.174
Episode 283 | Reward: 680.06 | Eps: 0.174
Episode 284 | Reward: 849.66 | Eps: 0.174
Episode 285 | Reward: 244.48 | Eps: 0.173
Episode 286 | Reward: 253.44 | Eps: 0.173
Episode 287 | Reward: 1085.14 | Eps: 0.173
Episode 288 | Reward: 1125.94 | Eps: 0.173
Episode 289 | Reward: 659.82 | Eps: 0.173
[Episode 290] Model saved to mario_dqn.pth
Episode 290 | Reward: 685.06 | Eps: 0.173
Episode 291 | Reward: 259.10 | Eps: 0.173
Episode 292 | Reward: 763.92 | Eps: 0.173
Episode 293 | Reward: 1829.76 | Eps: 0.173
Episode 294 | Reward: 1092.50 | Eps: 0.173
Episode 295 | Reward: 1097.44 | Eps: 0.173
Episode 296 | Reward: 1070.51 | Eps: 0.172
Episode 297 | Reward: 1354.77 | Eps: 0.172
Episode 298 | Reward: 798.26 | Eps: 0.172
Episode 299 | Reward: 251.26 | Eps: 0.172
[Episode 300] Model saved to mario_dqn.pth
Episode 300 | Reward: 1552.06 | Eps: 0.172
Episode 301 | Reward: 257.96 | Eps: 0.172
Episode 302 | Reward: 257.86 | Eps: 0.172
Episode 303 | Reward: 864.48 | Eps: 0.172
Episode 304 | Reward: 1256.94 | Eps: 0.172
Episode 305 | Reward: 254.64 | Eps: 0.172
Episode 306 | Reward: 813.30 | Eps: 0.172
Episode 307 | Reward: 665.32 | Eps: 0.172
Episode 308 | Reward: 1428.48 | Eps: 0.171
Episode 309 | Reward: 871.58 | Eps: 0.171
[Episode 310] Model saved to mario_dqn.pth
Episode 310 | Reward: 246.74 | Eps: 0.171
Episode 311 | Reward: 834.70 | Eps: 0.171
Episode 312 | Reward: 1379.14 | Eps: 0.171
Episode 313 | Reward: 1104.37 | Eps: 0.171
Episode 314 | Reward: 1454.29 | Eps: 0.171
Episode 315 | Reward: 256.86 | Eps: 0.171
Episode 316 | Reward: 648.92 | Eps: 0.171
Episode 317 | Reward: 1417.32 | Eps: 0.171
Episode 318 | Reward: 257.94 | Eps: 0.171
Episode 319 | Reward: 241.68 | Eps: 0.171
[Episode 320] Model saved to mario_dqn.pth
Episode 320 | Reward: 259.04 | Eps: 0.170
Episode 321 | Reward: 1080.95 | Eps: 0.170
Episode 322 | Reward: 1559.02 | Eps: 0.170
Episode 323 | Reward: 1099.54 | Eps: 0.170
Episode 324 | Reward: 655.54 | Eps: 0.170
Episode 325 | Reward: 260.18 | Eps: 0.170
Episode 326 | Reward: 1103.68 | Eps: 0.170
Episode 327 | Reward: 1852.04 | Eps: 0.170
Episode 328 | Reward: 666.40 | Eps: 0.170
Episode 329 | Reward: 1248.16 | Eps: 0.170
[Episode 330] Model saved to mario_dqn.pth
Episode 330 | Reward: 261.26 | Eps: 0.170
Episode 331 | Reward: 875.14 | Eps: 0.169
Episode 332 | Reward: 1442.54 | Eps: 0.169
Episode 333 | Reward: 1114.81 | Eps: 0.169
Episode 334 | Reward: 1454.61 | Eps: 0.169
Episode 335 | Reward: 1449.47 | Eps: 0.169
Episode 336 | Reward: 1241.04 | Eps: 0.169
Episode 337 | Reward: 759.18 | Eps: 0.169
Episode 338 | Reward: 1208.28 | Eps: 0.169
Episode 339 | Reward: 665.02 | Eps: 0.169
[Episode 340] Model saved to mario_dqn.pth
Episode 340 | Reward: 256.88 | Eps: 0.169
Episode 341 | Reward: 679.58 | Eps: 0.169
Episode 342 | Reward: 807.30 | Eps: 0.169
Episode 343 | Reward: 1463.00 | Eps: 0.168
Episode 344 | Reward: 1418.29 | Eps: 0.168
Episode 345 | Reward: 231.34 | Eps: 0.168
Episode 346 | Reward: 1411.95 | Eps: 0.168
Episode 347 | Reward: 254.58 | Eps: 0.168
Episode 348 | Reward: 1159.32 | Eps: 0.168
Episode 349 | Reward: 2530.52 | Eps: 0.168
[Episode 350] Model saved to mario_dqn.pth
Episode 350 | Reward: 677.88 | Eps: 0.168
Episode 351 | Reward: 1084.08 | Eps: 0.168
Episode 352 | Reward: 1424.72 | Eps: 0.168
Episode 353 | Reward: 667.14 | Eps: 0.168
Episode 354 | Reward: 797.00 | Eps: 0.168
Episode 355 | Reward: 663.44 | Eps: 0.167
Episode 356 | Reward: 248.98 | Eps: 0.167
Episode 357 | Reward: 234.52 | Eps: 0.167
Episode 358 | Reward: 879.62 | Eps: 0.167
Episode 359 | Reward: 236.88 | Eps: 0.167
[Episode 360] Model saved to mario_dqn.pth
Episode 360 | Reward: 1103.77 | Eps: 0.167
Episode 361 | Reward: 870.40 | Eps: 0.167
Episode 362 | Reward: 625.52 | Eps: 0.167
Episode 363 | Reward: 241.18 | Eps: 0.167
Episode 364 | Reward: 1078.50 | Eps: 0.167
Episode 365 | Reward: 1091.98 | Eps: 0.167
Episode 366 | Reward: 797.22 | Eps: 0.167
Episode 367 | Reward: 259.06 | Eps: 0.166
Episode 368 | Reward: 241.12 | Eps: 0.166
Episode 369 | Reward: 1453.60 | Eps: 0.166
[Episode 370] Model saved to mario_dqn.pth
Episode 370 | Reward: 1438.86 | Eps: 0.166
Episode 371 | Reward: 261.22 | Eps: 0.166
Episode 372 | Reward: 872.64 | Eps: 0.166
Episode 373 | Reward: 243.60 | Eps: 0.166
Episode 374 | Reward: 679.18 | Eps: 0.166
Episode 375 | Reward: 242.36 | Eps: 0.166
Episode 376 | Reward: 1711.94 | Eps: 0.166
Episode 377 | Reward: 245.58 | Eps: 0.166
Mario reached the flag! Awarding huge reward!
Episode 378 | Reward: 8217.28 | Eps: 0.166
Episode 379 | Reward: 246.86 | Eps: 0.165
[Episode 380] Model saved to mario_dqn.pth
Episode 380 | Reward: 630.54 | Eps: 0.165
Episode 381 | Reward: 246.84 | Eps: 0.165
Episode 382 | Reward: 245.68 | Eps: 0.165
Episode 383 | Reward: 631.72 | Eps: 0.165
Episode 384 | Reward: 255.68 | Eps: 0.165
Episode 385 | Reward: 1441.11 | Eps: 0.165
Episode 386 | Reward: 656.66 | Eps: 0.165
Episode 387 | Reward: 251.18 | Eps: 0.165
Episode 388 | Reward: 665.88 | Eps: 0.165
Episode 389 | Reward: 240.20 | Eps: 0.165
[Episode 390] Model saved to mario_dqn.pth
Episode 390 | Reward: 1111.56 | Eps: 0.165
Episode 391 | Reward: 684.76 | Eps: 0.164
Episode 392 | Reward: 1419.19 | Eps: 0.164
Episode 393 | Reward: 260.16 | Eps: 0.164
Episode 394 | Reward: 1117.39 | Eps: 0.164
Episode 395 | Reward: 637.32 | Eps: 0.164
Episode 396 | Reward: 247.92 | Eps: 0.164
Episode 397 | Reward: 1088.68 | Eps: 0.164
Episode 398 | Reward: 1449.32 | Eps: 0.164
Episode 399 | Reward: 679.38 | Eps: 0.164
[Episode 400] Model saved to mario_dqn.pth
Episode 400 | Reward: 1419.59 | Eps: 0.164
Episode 401 | Reward: 251.40 | Eps: 0.164
Episode 402 | Reward: 1424.38 | Eps: 0.164
Episode 403 | Reward: 872.56 | Eps: 0.163
Episode 404 | Reward: 255.76 | Eps: 0.163
Episode 405 | Reward: 1394.06 | Eps: 0.163
Episode 406 | Reward: 768.44 | Eps: 0.163
Episode 407 | Reward: 671.42 | Eps: 0.163
Episode 408 | Reward: 642.90 | Eps: 0.163
Episode 409 | Reward: 259.00 | Eps: 0.163
[Episode 410] Model saved to mario_dqn.pth
Episode 410 | Reward: 1129.20 | Eps: 0.163
Episode 411 | Reward: 255.64 | Eps: 0.163
Episode 412 | Reward: 666.08 | Eps: 0.163
Episode 413 | Reward: 251.34 | Eps: 0.163
Episode 414 | Reward: 1137.24 | Eps: 0.163
Episode 415 | Reward: 261.24 | Eps: 0.163
Episode 416 | Reward: 262.40 | Eps: 0.162
Episode 417 | Reward: 244.74 | Eps: 0.162
Episode 418 | Reward: 1542.28 | Eps: 0.162
Episode 419 | Reward: 259.10 | Eps: 0.162
[Episode 420] Model saved to mario_dqn.pth
Episode 420 | Reward: 1448.59 | Eps: 0.162
Episode 421 | Reward: 241.54 | Eps: 0.162
Episode 422 | Reward: 1119.16 | Eps: 0.162
Episode 423 | Reward: 666.30 | Eps: 0.162
Episode 424 | Reward: 682.70 | Eps: 0.162
Episode 425 | Reward: 661.78 | Eps: 0.162
Episode 426 | Reward: 665.06 | Eps: 0.162
Episode 427 | Reward: 682.78 | Eps: 0.162
Episode 428 | Reward: 239.28 | Eps: 0.161
Episode 429 | Reward: 654.48 | Eps: 0.161
[Episode 430] Model saved to mario_dqn.pth
Episode 430 | Reward: 634.10 | Eps: 0.161
Episode 431 | Reward: 640.00 | Eps: 0.161
Episode 432 | Reward: 257.98 | Eps: 0.161
Episode 433 | Reward: 1136.36 | Eps: 0.161
Episode 434 | Reward: 765.42 | Eps: 0.161
Episode 435 | Reward: 1461.04 | Eps: 0.161
Episode 436 | Reward: 2001.46 | Eps: 0.161
Episode 437 | Reward: 858.62 | Eps: 0.161
Episode 438 | Reward: 1452.01 | Eps: 0.161
Episode 439 | Reward: 669.66 | Eps: 0.161
[Episode 440] Model saved to mario_dqn.pth
Episode 440 | Reward: 1513.00 | Eps: 0.160
Episode 441 | Reward: 257.80 | Eps: 0.160
Episode 442 | Reward: 784.82 | Eps: 0.160
Episode 443 | Reward: 258.00 | Eps: 0.160
Episode 444 | Reward: 836.96 | Eps: 0.160
Episode 445 | Reward: 657.58 | Eps: 0.160
Episode 446 | Reward: 1454.14 | Eps: 0.160
Episode 447 | Reward: 680.60 | Eps: 0.160
Episode 448 | Reward: 1114.77 | Eps: 0.160
Episode 449 | Reward: 645.28 | Eps: 0.160
[Episode 450] Model saved to mario_dqn.pth
Episode 450 | Reward: 258.00 | Eps: 0.160
Episode 451 | Reward: 1412.98 | Eps: 0.160
Episode 452 | Reward: 1532.64 | Eps: 0.160
Episode 453 | Reward: 1535.98 | Eps: 0.159
Episode 454 | Reward: 2873.66 | Eps: 0.159
Episode 455 | Reward: 805.90 | Eps: 0.159
Episode 456 | Reward: 242.14 | Eps: 0.159
Episode 457 | Reward: 643.40 | Eps: 0.159
Episode 458 | Reward: 259.10 | Eps: 0.159
Episode 459 | Reward: 255.46 | Eps: 0.159
[Episode 460] Model saved to mario_dqn.pth
Episode 460 | Reward: 1420.09 | Eps: 0.159
Episode 461 | Reward: 786.06 | Eps: 0.159
Episode 462 | Reward: 259.06 | Eps: 0.159
Episode 463 | Reward: 738.16 | Eps: 0.159
Episode 464 | Reward: 235.82 | Eps: 0.159
Episode 465 | Reward: 670.54 | Eps: 0.159
Episode 466 | Reward: 1423.27 | Eps: 0.158
Episode 467 | Reward: 235.94 | Eps: 0.158
Episode 468 | Reward: 670.82 | Eps: 0.158
Episode 469 | Reward: 862.02 | Eps: 0.158
[Episode 470] Model saved to mario_dqn.pth
Episode 470 | Reward: 1070.92 | Eps: 0.158
Episode 471 | Reward: 625.98 | Eps: 0.158
Episode 472 | Reward: 779.52 | Eps: 0.158
Episode 473 | Reward: 656.50 | Eps: 0.158
Episode 474 | Reward: 658.62 | Eps: 0.158
Episode 475 | Reward: 1080.27 | Eps: 0.158
Episode 476 | Reward: 1700.38 | Eps: 0.158
Episode 477 | Reward: 241.28 | Eps: 0.158
Episode 478 | Reward: 254.54 | Eps: 0.157
Episode 479 | Reward: 1236.44 | Eps: 0.157
[Episode 480] Model saved to mario_dqn.pth
Episode 480 | Reward: 675.62 | Eps: 0.157
Episode 481 | Reward: 697.84 | Eps: 0.157
Episode 482 | Reward: 1105.95 | Eps: 0.157
Episode 483 | Reward: 244.60 | Eps: 0.157
Episode 484 | Reward: 785.80 | Eps: 0.157
Episode 485 | Reward: 1243.10 | Eps: 0.157
Episode 486 | Reward: 240.14 | Eps: 0.157
Episode 487 | Reward: 1101.78 | Eps: 0.157
Episode 488 | Reward: 658.06 | Eps: 0.157
Episode 489 | Reward: 828.10 | Eps: 0.157
[Episode 490] Model saved to mario_dqn.pth
Episode 490 | Reward: 256.88 | Eps: 0.157
Episode 491 | Reward: 1124.21 | Eps: 0.156
Episode 492 | Reward: 878.52 | Eps: 0.156
Episode 493 | Reward: 245.64 | Eps: 0.156
Episode 494 | Reward: 681.84 | Eps: 0.156
Episode 495 | Reward: 677.08 | Eps: 0.156
Episode 496 | Reward: 250.22 | Eps: 0.156
Episode 497 | Reward: 867.90 | Eps: 0.156
Episode 498 | Reward: 260.20 | Eps: 0.156
Episode 499 | Reward: 249.96 | Eps: 0.156
[Episode 500] Model saved to mario_dqn.pth
Episode 500 | Reward: 656.50 | Eps: 0.156
Episode 501 | Reward: 257.92 | Eps: 0.156
Episode 502 | Reward: 1026.34 | Eps: 0.156
Episode 503 | Reward: 653.18 | Eps: 0.156
Episode 504 | Reward: 257.82 | Eps: 0.155
Episode 505 | Reward: 1127.03 | Eps: 0.155
Episode 506 | Reward: 1438.65 | Eps: 0.155
Episode 507 | Reward: 251.18 | Eps: 0.155
Episode 508 | Reward: 1534.74 | Eps: 0.155
Episode 509 | Reward: 656.40 | Eps: 0.155
[Episode 510] Model saved to mario_dqn.pth
Episode 510 | Reward: 1422.23 | Eps: 0.155
Episode 511 | Reward: 1102.09 | Eps: 0.155
Episode 512 | Reward: 248.94 | Eps: 0.155
Episode 513 | Reward: 1421.00 | Eps: 0.155
Episode 514 | Reward: 1104.55 | Eps: 0.155
Episode 515 | Reward: 811.72 | Eps: 0.155
Episode 516 | Reward: 668.02 | Eps: 0.155
Episode 517 | Reward: 1086.97 | Eps: 0.154
Episode 518 | Reward: 666.04 | Eps: 0.154
Episode 519 | Reward: 805.68 | Eps: 0.154
[Episode 520] Model saved to mario_dqn.pth
Episode 520 | Reward: 243.40 | Eps: 0.154
Episode 521 | Reward: 254.66 | Eps: 0.154
Episode 522 | Reward: 245.54 | Eps: 0.154
Episode 523 | Reward: 1436.82 | Eps: 0.154
Episode 524 | Reward: 1124.16 | Eps: 0.154
Episode 525 | Reward: 243.32 | Eps: 0.154
Episode 526 | Reward: 247.82 | Eps: 0.154
Episode 527 | Reward: 234.56 | Eps: 0.154
Episode 528 | Reward: 629.08 | Eps: 0.154
Episode 529 | Reward: 671.32 | Eps: 0.154
[Episode 530] Model saved to mario_dqn.pth
Episode 530 | Reward: 245.76 | Eps: 0.153
Episode 531 | Reward: 256.88 | Eps: 0.153
Episode 532 | Reward: 1138.56 | Eps: 0.153
Episode 533 | Reward: 826.54 | Eps: 0.153
Traceback (most recent call last):
  File "/home/archer/code/super_mario_learning/train.py", line 402, in <module>
    run_training(num_episodes=5000, render=True, load_model="mario_dqn.pth")
  File "/home/archer/code/super_mario_learning/train.py", line 308, in run_training
    env.render()
  File "/home/archer/.local/lib/python3.10/site-packages/gym/core.py", line 329, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/core.py", line 329, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/order_enforcing.py", line 51, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/env_checker.py", line 55, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/nes_env.py", line 386, in render
    self.viewer.show(self.screen)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/_image_viewer.py", line 148, in show
    image.blit(0, 0, width=self._window.width, height=self._window.height)
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 904, in blit
    self.get_texture().blit(x, y, z, width, height)
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 835, in get_texture
    self._current_texture = self.create_texture(Texture, rectangle, force_rectangle)
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 827, in create_texture
    self.blit_to_texture(texture.target, texture.level,
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 995, in blit_to_texture
    glTexSubImage2D(target, level,
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/gl/lib.py", line 87, in errcheck
    def errcheck(result, func, arguments):
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/archer/code/super_mario_learning/train.py", line 402, in <module>
    run_training(num_episodes=5000, render=True, load_model="mario_dqn.pth")
  File "/home/archer/code/super_mario_learning/train.py", line 308, in run_training
    env.render()
  File "/home/archer/.local/lib/python3.10/site-packages/gym/core.py", line 329, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/core.py", line 329, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/order_enforcing.py", line 51, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/gym/wrappers/env_checker.py", line 55, in render
    return self.env.render(*args, **kwargs)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/nes_env.py", line 386, in render
    self.viewer.show(self.screen)
  File "/home/archer/.local/lib/python3.10/site-packages/nes_py/_image_viewer.py", line 148, in show
    image.blit(0, 0, width=self._window.width, height=self._window.height)
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 904, in blit
    self.get_texture().blit(x, y, z, width, height)
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 835, in get_texture
    self._current_texture = self.create_texture(Texture, rectangle, force_rectangle)
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 827, in create_texture
    self.blit_to_texture(texture.target, texture.level,
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/image/__init__.py", line 995, in blit_to_texture
    glTexSubImage2D(target, level,
  File "/home/archer/.local/lib/python3.10/site-packages/pyglet/gl/lib.py", line 87, in errcheck
    def errcheck(result, func, arguments):
KeyboardInterrupt
